#!/usr/bin/env bash

source _/functions

cp -r ./confs/examples ./confs/enabled

echo ""; echo_info "Parar o mundo"
_/down

for repo in 'moodle__block_suapattendance' 'moodle__local_suap' 'moodle__auth_suap' 'moodle__theme_maeve' 'moodle__image'; do
    if [[ ! -d ../$repo ]]; then
        echo "Clonando $repo"
        git clone https://github.com/cte-zl-ifrn/$repo.git ../$repo
    else
        echo "Repositório $repo já foi clonado anteriormente?"
    fi
done

mkdir -p volumes/ava/moodledata && chmod 777 volumes/ava/moodledata

echo ""; echo_info "Sobe o cache e o db em background"
_/backs

echo ""; echo_info "Construir as imagens"
_/build

echo ""; echo_info "Reiniciando o mundo novamente"
_/up
